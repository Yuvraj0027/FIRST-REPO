utility functions for Version 3